plugins {
    id 'eu.xenit.docker' version '5.2.0'
}

version = '0.1.0'
boolean isRelease = System.env.BRANCH_NAME?.startsWith("master")
if (!isRelease)
   version += "-SNAPSHOT"

task copyResources(type: Sync) {
     from "$project.projectDir/src/main/resources/templates"
     into "$project.buildDir/templates"
}
buildDockerImage.dependsOn(copyResources)

dockerFile {
    dockerFile = file("$project.projectDir/src/main/resources/Dockerfile")
    dockerBuild {
        // Repository to publish on.
        repository = 'private.docker.xenit.eu/customer/xenit/haproxy-alfresco'
        tags = ["${version}"]
        automaticTags = false
    }
}
